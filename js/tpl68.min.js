var module_inits = [];

function load_init_modules() {
    for (var i = 0; i < module_inits.length; i++) {
        module_inits[i]();
    }
}

function call_me(fun) {
    module_inits.push(fun);
}

document.ontouchmove = function(e) {
    //e.preventDefault();
}

// = load_init_modules;

function playPhoto() {

    // 相册封面
    loadUserImages();
    $.when(loadingdef).done(function() {
        $("#wrapper_player_cover_bkgnd").css("display", "block");
        setTimeout("$('#wrapper_cover').addClass('effect_fadeOut');", 3000);
        setTimeout(function() {
            // window.setTimeout(function d() {
            //     playEnd()
            // }, 100)
            play();
        }, 3100)
    })




    function play() {
        $("#div_player").append('<div id="container"><img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/bg.jpg"><div id="pagetitle"><div style="position:absolute;width:372px;height:187px;top:315px;left:65px;overflow:hidden;background-color:rgba(255,255,255,.6)"><div style="position:absolute;width:312px;height:90px;top:68px;left:30px;overflow:hidden"><div style="position:absolute;width:312px;height:90px;display:table;overflow:hidden"><div id="titlecontent" style="width:312px;height:90px;vertical-align:top;display:table-cell;text-align:center;font-size:36px;line-height:45px;color:#f5806e"></div></div></div></div><div id="wenzi"></div></div><div id="div1box"><div id="div1con" class="divcon"><div id="div1" class="divimg"><img id="img1" style="position:absolute"></div><div id="wenzi1_1" class="wenzi_1"></div><div id="wenzi1_2" class="wenzi_2"></div></div></div><div id="div2box"><div id="div2con" class="divcon"><div id="div2" class="divimg"><img id="img2" style="position:absolute"></div><div id="wenzi2_1" class="wenzi_1"></div><div id="wenzi2_2" class="wenzi_2"></div></div></div><div id="div3box"><div id="div3con" class="divcon"><div id="div3" class="divimg"><img id="img3" style="position:absolute"></div><div id="wenzi3_1" class="wenzi_1"></div><div id="wenzi3_2" class="wenzi_2"></div></div></div><div id="div4box"><div id="div4con" class="divcon"><div id="div4" class="divimg"><img id="img4" style="position:absolute"></div><div id="wenzi4_1" class="wenzi_1"></div><div id="wenzi4_2" class="wenzi_2"></div></div></div><img class="main_title" src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic3.png"> <img class="bottom_cloud1" src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic9.png"> <img class="bottom_cloud2" src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic9.png"> <img class="bottom_cloud3" src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic9.png"><div class="caobox"><div class="cao"><img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic1.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/p3.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/p1.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic12.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic5.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic10.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic8.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic2.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic14.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic11.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/p2.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic6.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/p.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic1.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/p3.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/p1.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic12.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic5.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic10.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic8.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic2.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic14.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic11.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/p2.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic6.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/p.png" alt class="cao1"></div><div class="cao cao2"><img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic1.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/p3.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/p1.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic12.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic5.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic10.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic8.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic2.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic14.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic11.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/p2.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic6.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/p.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic1.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/p3.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/p1.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic12.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic5.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic10.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic8.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic2.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic14.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic11.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/p2.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic6.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/p.png" alt class="cao1"></div><div class="cao cao3"><img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic1.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/p3.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/p1.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic12.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic5.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic10.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic8.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic2.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic14.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic11.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/p2.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic6.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/p.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic1.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/p3.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/p1.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic12.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic5.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic10.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic8.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic2.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic14.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic11.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/p2.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic6.png" alt class="cao1"> <img src="http://referer-image.szwwy.com/coolphoto/img/tpl68/p.png" alt class="cao1"></div></div><div class="brid1_move"><div class="bird1"><img class="bird1_1" src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic00.png"> <img class="bird1_2" src="http://referer-image.szwwy.com/coolphoto/img/tpl68/b.png"> <img class="bird1_3" src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic7.png"></div></div><div class="brid2_move"><div class="bird2"><img class="bird2_1" src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic13.png"> <img class="bird2_2" src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic0.png"> <img class="bird2_3" src="http://referer-image.szwwy.com/coolphoto/img/tpl68/pic4.png"></div></div></div>');

        var top = [];
        var left = [];
        for (var i = 0; i < $(".cao1").length; i++) {
            var topNum = parseInt(Math.random() * 1500);
            var leftNum = parseInt(Math.random() * 500);
            left[i] = leftNum;
            top[i] = topNum;
            $(".cao1").eq(i).css({
                top: top[i] + "px",
                left: left[i] + 'px'
            })
        }

        var get_pid = function(url) {
            var index1 = url.indexOf("?");
            if (index1 != -1) {
                url = url.substr(0, index1);
            }
            return url.toString().substr(url.lastIndexOf("/") + 1);
        }

        function id(a) {
            return document.getElementById(a)
        }

        function showtitle() {
            id('pagetitle').style.webkitAnimation = 'title_in 2s linear both';
            $(".main_title").css("-webkit-animation", "title_in 2s linear both");
            id('titlecontent').innerHTML = e_desc
        }

        function distitle() {
            nowReShow1()
        }

        function div_juxing2_act_to() {
            $(".div_juxing2").addClass("div_juxing2_act")
        }

        function show1() {
            setImageindex();
            set_items_position('1');
            id('div1con').style.webkitAnimation = 'div1_in 2s ease-out both';
            setTimeout(show2, 6000)
        }

        function show2() {
            setImageindex();
            set_items_position('2');
            id('div1con').style.webkitAnimation = 'div1_out 1.5s ease-in both';
            id('div2con').style.webkitAnimation = 'div2_in 2s ease-out 1s both';
            setTimeout(show3, 6000)
        }

        function show3() {
            setImageindex();
            set_items_position('3');
            id('div2con').style.webkitAnimation = 'div2_out 1.5s ease-in both';
            id('div3con').style.webkitAnimation = 'div3_in 2s ease-out 1s both';
            setTimeout(show4, 6000)
        }

        function show4() {
            setImageindex();
            set_items_position('4');
            id('div3con').style.webkitAnimation = 'div3_out 1.5s ease-in both';
            id('div4con').style.webkitAnimation = 'div4_in 2s ease-out 1s both';
            setTimeout(show1_1, 6000)
        }

        function show1_1() {
            setImageindex();
            set_items_position('1');
            id('div4con').style.webkitAnimation = 'div4_out 1.5s ease-in both';
            id('div1con').style.webkitAnimation = 'div1_in 2s ease-out 1s both';
            setTimeout(show2, 6000)
        }

        function set_items_position(a) {
            var b = image_size_width[image_url_index] / image_size_height[image_url_index];
            var c = id('div' + a);
            var d = id('img' + a);
            d.src = Onload_imgs_url[image_url_index];
            if (b >= 1) {
                id('wenzi' + a + '_1').style.top = '158px';
                id('wenzi' + a + '_2').style.top = '158px';
                c.style.width = '460px';
                if (b > (460 / 300)) {
                    c.style.height = '300px';
                    d.style.height = '300px';
                    d.style.width = 300 * b + 'px';
                    d.style.left = (460 - 300 * b) / 2 + 'px';
                    d.style.top = '0px'
                } else {
                    c.style.height = 460 / b + 'px';
                    d.style.width = '460px';
                    d.style.height = 460 / b + 'px';
                    d.style.left = '0px';
                    d.style.top = '0px'
                }
                c.style.left = '20px';
                c.style.top = '220px'
            } else {
                id('wenzi' + a + '_1').style.top = '38px';
                id('wenzi' + a + '_2').style.top = '38px';
                c.style.width = '380px';
                if (b < (380 / 600)) {
                    c.style.height = '600px';
                    d.style.width = '380px';
                    d.style.height = 380 / b + 'px';
                    d.style.left = '0px';
                    d.style.top = (600 - 380 / b) / 2 + 'px'
                } else {
                    c.style.height = 380 / b + 'px';
                    d.style.width = '380px';
                    d.style.height = 380 / b + 'px';
                    d.style.left = '0px';
                    d.style.top = '0px'
                }
                c.style.left = '60px';
                c.style.top = '130px'
            }
            $(d).parent().find(".divText").remove();
            $(d).parent().append('<span class="divText imgTxt' + image_url_index + '"></span>');
            //$(".imgTxt" + image_url_index).html(slider_images_txt[image_url_index]);
            image_url_index++
        }

        function LocTo(a) {
            top.location.href = a
        }

        function GetLocTo() {
            return (location.host)
        }
        var domNow = "weixin";

        function nowReTo(a) {
            LocTo(a)
        }

        function nowGetReTo() {
            domNow = GetLocTo()
        }

        function nowReShow1() {


            id('pagetitle').style.webkitAnimation = 'title_out 2s ease-in both';
            $(".main_title").css("-webkit-animation", "main_title_out 2s ease-in both");
            setTimeout(function() {
                $(".main_title").css("-webkit-animation", "main_title_move 3s linear both infinite")
            }, 2200);
            setTimeout(show1, 2000);
            setTimeout(div_juxing2_act_to, 3000)
        }

        var image_size_width = [];
        var image_size_height = [];
        var image_url_index = 0;
        var have_num = 0;
        var error_num = 0;
        var canshow = true;
        var reshow = false;
        var delaytime = 5500;

        function load_images() {
            reshow = false;
            image_size_width = [];
            image_size_height = [];
            Onload_imgs_url = [];
            image_url_index = 0;
            have_num = 0;
            error_num = 0;
            begin_titletime = new Date();
            begin_titletime = begin_titletime.getTime();
            canshow = true;
            //showtitle();
            for (var i = 0; i < images.length; i++) {
                var a = new Image();
                a.index = i;
                a.src = images[i][1];
                a.onload = image_onload;
                a.onerror = image_onerror;
                Onload_imgs_url[i] = 'loading'
            }
        }

        function image_onerror(a) {
            var b = a.target;
            var c = b.index;
            if (c < 10) error_num++;
            Onload_imgs_url[c] = 'not find';
            if ((have_num + error_num >= 10 || images.length == (have_num + error_num)) && canshow == true) {
                reshow = false;
                canshow = false;
                if (have_num == 0) return;
                distitle()
            }
        }

        function image_onload(a) {
            //var images = mvCfg.pics;
            if (reshow == true) return;
            var b = a.target;
            var c = b.index;
            if (c < 10) {
                have_num++
            }
            Onload_imgs_url[c] = b.src;
            image_size_height[c] = b.height;
            image_size_width[c] = b.width;
            if ((have_num + error_num >= 10 || images.length == (have_num + error_num)) && canshow == true) {
                reshow = false;
                canshow = false;
                if (have_num == 0) return;
                distitle()
            }
        }

        function setImageindex() {
            if (image_url_index == Onload_imgs_url.length) image_url_index = 0;
            while (Onload_imgs_url[image_url_index] == 'not find' || Onload_imgs_url[image_url_index] == 'loading') {
                image_url_index++;
                if (image_url_index == Onload_imgs_url.length) image_url_index = 0
            }
        }

        call_me(load_images);
        load_init_modules();
    }
}
